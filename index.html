<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>유아른 계산기</title>

  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard/dist/web/static/pretendard.css">

  <style>
    :root{
      --bg:#f7f8fb; --card:#ffffff; --line:#e6e8f0; --fg:#0e1116; --muted:#6b7280; --accent:#2563eb; --ink:#ffffff;
      --r-xl:14px; --r-md:12px; --shadow:0 8px 24px rgba(15,23,42,.06);
    }
    *{box-sizing:border-box}
    body{
      margin:0;background:var(--bg);color:var(--fg);
      font:14.5px/1.55 Pretendard, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
    }

    .page{max-width:2360px;margin:8px auto;padding:0 14px;
      display:grid;grid-template-columns:3fr 2fr;column-gap:20px;row-gap:0;
      min-height:calc(100dvh - 16px);}
    
    .cat{margin-top:0}
    .cat h3{margin:2px 2px 6px;font-size:14px;font-weight:700;color:#111827;}
    .grid{display:grid;grid-template-columns:repeat(5,185px);gap:10px;}
    @media (max-width:1800px){ .grid{grid-template-columns:repeat(4,185px);} }
    @media (max-width:1180px){ .grid{grid-template-columns:repeat(3,185px);} }
    @media (max-width:880px){ .grid{grid-template-columns:repeat(2,185px);} }

    .product{
      background:var(--card);border:1px solid var(--line);border-radius:var(--r-md);
      padding:10px;box-shadow:var(--shadow);
      display:flex;flex-direction:column;gap:8px;cursor:pointer;transition:0.2s;
      width:185px;
    }
    .product.selected{border:2px solid var(--accent);box-shadow:0 0 0 3px rgba(37,99,235,0.2);}
    .p-thumb{width:50px;height:50px;border-radius:8px;object-fit:cover;background:#eef2f7;}
    .p-info{display:flex;flex-direction:column;align-items:flex-start;gap:2px;}
    .p-name{font-size:13px;font-weight:700;line-height:1.35;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}
    .p-price{font-size:12.5px;color:var(--accent);}

    .qtyRow{display:flex;justify-content:center;align-items:center;gap:6px;}
    .btn{border:1px solid var(--line);background:#f3f5fa;border-radius:8px;
      width:28px;height:28px;cursor:pointer;font-weight:800;font-size:16px;
      display:flex;align-items:center;justify-content:center;}
    .badge{min-width:34px;text-align:center;font-weight:800;}

    .panel{background:var(--card);border:1px solid var(--line);border-radius:var(--r-xl);
      padding:12px;position:sticky;top:0;align-self:start;box-shadow:var(--shadow);
      max-height:calc(100dvh - 20px);overflow:auto;min-width:560px;}
    .panel h3{margin:0 0 8px;font-size:15px;font-weight:800}
    .empty{padding:14px;border:1px dashed var(--line);border-radius:12px;text-align:center;color:#6b7280;background:#fafbff}
    table{width:100%;border-collapse:separate;border-spacing:0;margin-top:6px;border-radius:12px;border:1px solid var(--line);table-layout:fixed}
    thead th{background:#f6f7fb;font-weight:700;font-size:12.5px;padding:8px;border-bottom:1px solid var(--line);position:sticky;top:0;}
    tbody td{padding:8px;border-bottom:1px solid var(--line);font-size:13.5px;}
    tbody tr:nth-child(even){background:#fafbff}
    .qtyCtl{display:inline-flex;align-items:center;gap:6px}
    .btn-sm{width:24px;height:24px;border:1px solid var(--line);background:#f3f5fa;border-radius:6px;cursor:pointer;font-weight:800;display:flex;align-items:center;justify-content:center}
    .totals{margin-top:10px;display:flex;flex-direction:column;gap:6px}
    .totalLine{display:flex;justify-content:space-between;align-items:center}
    .gift{font-weight:800}
    .actions{margin-top:10px;display:flex;gap:8px}
    .pay{flex:1;background:var(--accent);border:1px solid var(--accent);color:var(--ink);border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer;font-size:15px}
    .note{font-size:12px;color:#6b7280;margin-top:6px}
  </style>
</head>
<body>
  <div class="page">
    <main><div id="cats"></div></main>
    <aside class="panel">
      <h3>선택한 제품</h3>
      <div id="cartEmpty" class="empty">아직 선택된 제품이 없습니다.</div>
      <div id="cartWrap" style="display:none">
        <table>
          <thead>
            <tr>
              <th style="width:50%">상품명</th>
              <th style="width:16%">수량</th>
              <th style="width:17%">단가</th>
              <th style="width:17%">금액</th>
            </tr>
          </thead>
          <tbody id="cartBody"></tbody>
        </table>
        <div class="totals">
          <div class="totalLine"><span>총 수량</span><strong id="totalQty">0개</strong></div>
          <div class="totalLine"><span>총합</span><strong id="grand">0원</strong></div>
          <div class="totalLine gift"><span>사은품</span><span id="gift">없음</span></div>
        </div>
        <div class="actions"><button id="pay" class="pay">결제</button></div>
      </div>
      <div class="note">전송 후 모든 항목이 초기화됩니다.</div>
    </aside>
  </div>
<script>
const IMG_BASE = "images"; 

// 제품 데이터 (예시: 실제로는 민정님 상품 리스트 반영)
const products = [
  {key:"p1", name:"제품1", price:10000, img:"p1.jpg"},
  {key:"p2", name:"제품2", price:20000, img:"p2.jpg"},
  {key:"p3", name:"제품3", price:30000, img:"p3.jpg"},
  // ... 나머지 상품도 이어서
];
const productMap = Object.fromEntries(products.map(p=>[p.key,p]));

const catsEl = document.getElementById('cats');
const cartEmptyEl = document.getElementById('cartEmpty');
const cartWrapEl = document.getElementById('cartWrap');
const cartBodyEl = document.getElementById('cartBody');
const grandEl = document.getElementById('grand');
const giftEl = document.getElementById('gift');
let cart = {};

// 카테고리 & 카드 그리기
catsEl.innerHTML = `
  <div class="cat">
    <h3>카테고리</h3>
    <div class="grid">
      ${products.map(p=>`
        <div class="product" id="card-${p.key}" onclick="add('${p.key}')">
          <img class="p-thumb" src="${IMG_BASE}/${p.img}" alt="">
          <div class="p-info">
            <div class="p-name">${p.name}</div>
            <div class="p-price">${p.price.toLocaleString()}원</div>
          </div>
          <div class="qtyRow">
            <button class="btn" onclick="event.stopPropagation();sub('${p.key}')">−</button>
            <span class="badge" id="badge-${p.key}">0</span>
            <button class="btn" onclick="event.stopPropagation();add('${p.key}')">＋</button>
          </div>
        </div>
      `).join('')}
    </div>
  </div>
`;

// 담기 / 빼기
function add(k){ cart[k]=(cart[k]||0)+1; render(); }
function sub(k){ if(cart[k]){ cart[k]--; if(cart[k]<=0) delete cart[k]; render(); }}

// 사은품 로직
function giftBy(total){
  if(total>=100000) return "마스크팩 + 립밤 중 택1 + 리사이클파우치";
  if(total>=50000)  return "마스크팩 + 립밤 중 택1";
  if(total>=30000)  return "마스크팩";
  return "없음";
}

// 렌더링 (총 수량 포함)
function render(){
  Object.keys(productMap).forEach(k=>{
    document.getElementById(`badge-${k}`).textContent = String(cart[k]||0);
    const card=document.getElementById(`card-${k}`);
    if(cart[k]>0) card.classList.add("selected");
    else card.classList.remove("selected");
  });

  const keys=Object.keys(cart);
  if(!keys.length){
    cartEmptyEl.style.display='';
    cartWrapEl.style.display='none';
    grandEl.textContent='0원';
    giftEl.textContent='없음';
    document.getElementById('totalQty').textContent='0개';
    return;
  }
  cartEmptyEl.style.display='none';
  cartWrapEl.style.display='';

  let total=0,totalQty=0;
  cartBodyEl.innerHTML=keys.map(k=>{
    const p=productMap[k],q=cart[k],sub=q*p.price;
    total+=sub; totalQty+=q;
    return `<tr data-key="${k}">
      <td class="nameCell" title="${p.name}">${p.name}</td>
      <td><div class="qtyCtl">
        <button class="btn-sm" data-act="minus">−</button>
        <span>${q}</span>
        <button class="btn-sm" data-act="plus">＋</button>
      </div></td>
      <td>${p.price.toLocaleString()}원</td>
      <td>${sub.toLocaleString()}원</td>
    </tr>`;
  }).join('');

  grandEl.textContent=`${total.toLocaleString()}원`;
  giftEl.textContent=giftBy(total);
  document.getElementById('totalQty').textContent=`${totalQty}개`;
}

// 수량 조절 버튼 이벤트
cartBodyEl.addEventListener('click',e=>{
  const btn=e.target.closest('button');
  if(!btn) return;
  const tr=e.target.closest('tr');
  const key=tr.dataset.key;
  if(btn.dataset.act==='minus') sub(key);
  if(btn.dataset.act==='plus') add(key);
});

// 전송 로직
document.getElementById('pay').addEventListener('click',()=>{
  if(!Object.keys(cart).length){ alert("선택된 제품이 없습니다."); return; }

  const formData=new FormData();

  // 여기서 entry 매핑 (예: 23개 전부)
  // 예시는 p1 → entry.641954362, p2 → entry.73760492 ...
  if(cart["p1"]) formData.append("entry.641954362", cart["p1"]);
  if(cart["p2"]) formData.append("entry.73760492", cart["p2"]);
  if(cart["p3"]) formData.append("entry.527065283", cart["p3"]);
  // ... 나머지 23개 전부 이어서 넣기

  fetch("https://docs.google.com/forms/d/e/1FAIpQLSdHqrnkW6r7.../formResponse",{
    method:"POST",
    body:formData,
    mode:"no-cors"
  });

  alert("전송 완료!");
  cart={}; render();
});
</script>
</body>
</html>
